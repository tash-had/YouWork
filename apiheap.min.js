/*TITLE: Apiheap.js : JavaScript Library AUTHOR: Tash-had Saqif | tash-had.com PROJECT: tash-had.github.io/apiheapjs */function apiheap(a,b){if(SOURCE_ID=a.toLowerCase(),"reddit"===SOURCE_ID)this.reddit=function(a,b,c){this.SOURCE_NAME=a,this.LISTING=b,this.OPT_PARAMS=c;var d="https://www.reddit.com/";this.FINAL_URL=isUndefined(this.SOURCE_NAME)?isUndefined(this.LISTING)?d+".json":isUndefined(this.OPT_PARAMS)?d+this.LISTING+"/.json":d+this.LISTING+"/.json?"+this.OPT_PARAMS:isUndefined(this.LISTING)?d+"r/"+this.SOURCE_NAME+"/.json":isUndefined(this.OPT_PARAMS)?d+"r/"+this.SOURCE_NAME+"/"+this.LISTING+"/.json":d+"r/"+this.SOURCE_NAME+"/"+this.LISTING+"/.json?"+this.OPT_PARAMS,this.RESPONSE=apiRequest("json",this.FINAL_URL)},this.parse=function(a){var b=[],c=this.RESPONSE,d=a;try{isUndefined(d)?b=c.responseJSON.data.children:$(c.responseJSON.data.children).each(function(a,c){b.push(c.data[d])})}catch(e){errorHandle("error| LOG:"+e+" ...reddiit parse error")}finally{return b}};else if("tumblr"===SOURCE_ID)this.SOURCE_KEY=b,this.tumblr=function(a,b,c){this.SOURCE_NAME=a;var d="http://api.tumblr.com/v2/blog/"+this.SOURCE_NAME;isUndefined(b)?isUndefined(c)?this.FINAL_URL=d+"/posts/?api_key="+this.SOURCE_KEY:(this.OPT_PARAMS=c,this.FINAL_URL=d+"/posts/?api_key="+this.SOURCE_KEY+"&"+this.OPT_PARAMS):(this.REQ_ITEM=b,isUndefined(c)?this.FINAL_URL=d+"/posts/"+this.REQ_ITEM+"?api_key="+this.SOURCE_KEY:(this.OPT_PARAMS=c,this.FINAL_URL=d+"/posts/"+this.REQ_ITEM+"?api_key="+this.SOURCE_KEY+"&"+this.OPT_PARAMS)),this.RESPONSE=apiRequest("jsonp",this.FINAL_URL)},this.parse=function(a){var b=this.RESPONSE.responseJSON.response,c=a;if(isUndefined(c))return b.posts;if("blog_info"===c)return b.blog;if("total_posts"===c)return b.total_posts;var d=[];try{$(b.posts).each(function(a,b){"photos_url"===c?$(b).each(function(a,b){d.push(b.photos[0].original_size.url)}):d.push(b[c])})}catch(e){}finally{return d}};else if("bitly"===SOURCE_ID){this.SOURCE_KEY=b;var c="https://api-ssl.bitly.com/v3/shorten?access_token="+this.SOURCE_KEY+"&";this.bitly=function(a){this.SOURCE_NAME=a,this.FINAL_URL=c+"longUrl="+encodeURIComponent(this.SOURCE_NAME)+"&format=json",this.RESPONSE=apiRequest("json",this.FINAL_URL)},this.parse=function(){var a=JSON.parse(this.RESPONSE.responseText);return a.data.url}}else"imgur"===SOURCE_ID?(this.SOURCE_KEY=b,this.imgur=function(a,b,c){if(this.TAG=a,this.OPT_PARAMS=b,this.TOPIC=c,isUndefined(a)&&isUndefined(b)&&isUndefined(c))this.TOPIC=!0;else{this.FINAL_URL=c?isUndefined(this.OPT_PARAMS)?"https://api.imgur.com/3/topics/"+this.TAG:"https://api.imgur.com/3/topics/"+this.TAG+"/"+this.OPT_PARAMS:isUndefined(this.TAG)?isUndefined(this.OPT_PARAMS)?"https://api.imgur.com/3/gallery/":"https://api.imgur.com/3/gallery/"+this.OPT_PARAMS:isUndefined(this.OPT_PARAMS)?"https://api.imgur.com/3/gallery/t/"+this.TAG:"https://api.imgur.com/3/gallery/t/"+this.TAG+"/"+this.OPT_PARAMS;try{this.RESPONSE=$.ajax({url:this.FINAL_URL,dataType:"json",type:"GET",cache:!1,headers:{Authorization:"Client-ID "+this.SOURCE_KEY}})}catch(d){errorHandle("error| LOG:"+d+" ...imgur request error")}}},this.parse=function(a){var b=[],c=this.TOPIC,d=this.RESPONSE;if(isUndefined(a))return!c||isUndefined(c)?d.responseJSON.data.items:d.responseJSON.data;try{!c||isUndefined(c)?$(d.responseJSON.data.items).each(function(c,d){$(d).each(function(c,d){b.push(d[a])})}):$(d.responseJSON.data).each(function(c,d){$(d).each(function(c,d){b.push(d[a])})})}catch(e){}finally{return b}}):"youtube"===SOURCE_ID?(this.SOURCE_KEY=b,this.youtube=function(a,b,c,d){if(this.TYPE=a,this.PART=b,this.OPT_PARAMS=c,this.PAGE_TOKEN=d,isUndefined(this.TYPE)||isUndefined(this.PART))errorHandle("error| LOG: youtube request error: type and part parameters are required");else{var e="https://www.googleapis.com/youtube/v3/"+this.TYPE+"?part="+this.PART+"&key="+this.SOURCE_KEY;this.FINAL_URL=isUndefined(this.OPT_PARAMS)?isUndefined(this.PAGE_TOKEN)?e:e+"&pageToken="+this.PAGE_TOKEN:isUndefined(this.PAGE_TOKEN)?e+"&"+this.OPT_PARAMS:e+"&"+this.OPT_PARAMS+"&pageToken="+this.PAGE_TOKEN}this.RESPONSE=apiRequest("json",this.FINAL_URL)},this.parse=function(a,b){if(isUndefined(b))errorHandle("youtube parse error: you must request an item as a parameter");else{var c=a,d=b,e=[];try{$(c).each(function(a,b){$(b.responseJSON.items).each(function(a,b){switch(d){case"type":e.push(b.id.kind);break;case"vid_links":e.push("https://www.youtube.com/watch?v="+b.id.videoId);break;case"vid_ids":e.push(b.id.videoId);break;case"vid_dates":e.push(b.snippet.publishedAt);break;case"vid_titles":e.push(b.snippet.title);break;case"vid_thumbnails":e.push(b.snippet.thumbnails.high.url);break;case"chan_links":e.push("https://www.youtube.com/channel/"+b.snippet.channelId);break;case"chan_ids":e.push(b.snippet.channelId);break;case"chan_names":e.push(b.snippet.channelTitle);break;case"vid_descriptions":e.push(b.snippet.description)}})})}catch(f){errorHandle("youtube parse error")}finally{return e}}}):"openweathermap"===SOURCE_ID?(this.SOURCE_KEY=b,this.weather=function(a,b){this.CITY=a,this.CUSTOM=b,isUndefined(this.CUSTOM)?isUndefined(this.CITY)?errorHandle("openweathermap error: missing perams"):this.FINAL_URL="http://api.openweathermap.org/data/2.5/weather?q="+this.CITY+"&appid="+this.SOURCE_KEY:this.FINAL_URL="http://api.openweathermap.org/data/2.5/weather?"+this.CUSTOM+"&appid="+this.SOURCE_KEY,this.RESPONSE=apiRequest("json",this.FINAL_URL)},this.parse=function(a){var b=this.RESPONSE,c=a;return isUndefined(c)?b.responseJSON:"weather"===c?b.responseJSON[c][0].description:b.responseJSON[c]}):errorHandle("error| LOG: invalid source")}function apiRequest(a,b){var c;try{c=$.ajax({url:b,dataType:a,type:"GET",cache:!1})}catch(d){errorHandle("Request Error. Log| "+d)}finally{return c}}function errorHandle(a){alert("APIHEAP ERROR: "+a)}function html_strip(a){return jQuery("<p>"+a+"</p>").text()}function preventDuplicate(a,b){return-1===b.indexOf(a)&&"undefined"!==a&&void 0!==a&&"default"!==a&&void 0!==typeof a&&"null"!==a&&null!==a?!0:!1}function pageToken(a){return a.responseJSON.nextPageToken}isUndefined=function(a){return"undefined"===typeof a||null===a||"null"===a||void 0===a?!0:!1};